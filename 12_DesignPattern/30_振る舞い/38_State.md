# 振る舞いに関するパターン

## State: 状態のクラス化

### 公式説明

オブジェクトの内部状態が変化したときに、オブジェクトが振る舞いを変えるようにする。
クラス内では、振る舞いの変化を記述せず、状態を表すオブジェクトを導入することでこれを実現する。

### 解説

- 基本
  - 状態を表すオブジェクトごとに振る舞いを記述する
- 詳細
  - `IState`インターフェースを実装した`OffState`と`OnState`クラスを作る
    - `IState`では`UpState()`メソッドを作り、各状態にて次の状態クラスに変化する処理を書く
    - `UpState()`は`Context`を受け取り、`Context`の`ChangeState()`に次の`IState`を渡す
  - この状態を`Context`クラスで保持する
    - `Context`は`_state`に状態オブジェクトを代入して持つ
    - `Context`の`Up()`メソッドを呼ぶと`_state`の`UpState(this)`が呼ばれるようにする
    - `ChangeState()`メソッドで、受け取った`IState`を`_state`に代入して状態を更新する
    - `Up()`は public とし、`ChangeState()`は状態クラスから呼ぶため Internal とする
    - 特殊なケースの場合は、`Context`内で`_state`を変更しても良い
  - クライアントは`Context`クラスをインスタンス化して保持する
    - 状態はシングルトンにするのが望ましい
- メリット
  - 状態ごとの処理が整理され、保守性や可読性が上がる
  - 新しい状態の追加が容易になる
